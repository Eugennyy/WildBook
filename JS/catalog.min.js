"use strict";null!=localStorage.getItem("WildBook's books")&&null!=localStorage.getItem("WildBook's cart")&&null!=localStorage.getItem("WildBook's profiles")||(localStorage.setItem("WildBook's books",JSON.stringify(booksData)),localStorage.setItem("WildBook's cart",JSON.stringify(cartData)),localStorage.setItem("WildBook's profiles",JSON.stringify(profilesData))),window.addEventListener("hashchange",checkAdress);let $buttonUp=$(".buttonUp");function parseJSON(){return JSON.parse(localStorage.getItem("WildBook's books"))}function parseProfilesData(){return JSON.parse(localStorage.getItem("WildBook's profiles"))}function parseCartData(){return JSON.parse(localStorage.getItem("WildBook's cart"))}$buttonUp.hide(),$buttonUp.on("click",()=>{window.scrollTo({top:0,behavior:"smooth"})}),function e(){window.addEventListener("scroll",e),$(document).scrollTop()>$(window).height()?$buttonUp.fadeIn(400):$buttonUp.fadeOut(400)}(),$(function(){$("html").animate({scrollTop:$("#catalog").offset().top},650)});let adminRight,cartActive,isActive,buttonEntrance=document.querySelector(".modalEntrance__button"),buttonBlock=document.querySelector(".menu__item_profileBlock"),profilePhoto=document.querySelector(".modalProfile__photo"),profileEmail=document.querySelector("#profileEmail"),profileLogin=document.querySelector("#profileLogin"),profilePassword=document.querySelector("#profilePassword"),cart=document.querySelector("#cart"),cartItems=parseCartData(),cartButton=document.querySelector("#cartButton"),profiles=parseProfilesData();function profileEntrance(){let e=document.querySelector("#accountLogin"),t=document.querySelector("#accountPassword"),o=document.querySelector('[data-fancybox="modalAccount"]'),n=e.value,a=t.value;profiles.forEach(e=>{if(n===e.login&&a===e.password){!0===e.admin&&(adminRight=!0),e.active=!0,localStorage.setItem("WildBook's profiles",JSON.stringify(profiles)),isActive=!0,cartActive=!0,$.fancybox.close(),o.remove();let t=document.createElement("a");t.classList.add("menu__link","menu__link_style"),t.innerText=e.login,t.setAttribute("data-fancybox","modalProfile"),t.setAttribute("data-src","#modalProfile"),t.style.cursor="pointer",buttonBlock.prepend(t),profilePhoto.setAttribute("src",`${e.photo}`),profileEmail.value=e.email,profileLogin.value=e.login,profilePassword.value=e.password,checkCart()}})}buttonEntrance.addEventListener("click",function(e){e.preventDefault(),profileEntrance()});let photoChanged,profileIndex,buttonProfileEdit=document.querySelector(".modalProfile__edit");buttonProfileEdit.addEventListener("click",function(e){e.preventDefault();let t,o={email:profileEmail.value,login:profileLogin.value,password:profilePassword.value,photo:profilePhoto.src,active:!0};profiles.forEach(e=>{if(profileIndex=profiles.indexOf(e),(o.email!==e.email||o.login!==e.login||o.password!==e.password||!0===photoChanged)&&!0===(t=confirm("Применить внесенные изменения?")))if(photoChanged=!1,!0===e.admin){let e={email:profileEmail.value,login:profileLogin.value,password:profilePassword.value,photo:profilePhoto.src,admin:!0,active:!0};profiles[profileIndex]=e,localStorage.setItem("WildBook's profiles",JSON.stringify(profiles))}else profiles[profileIndex]=o,localStorage.setItem("WildBook's profiles",JSON.stringify(profiles))})});let buttonProfileExit=document.querySelector(".modalProfile__exit");function changeProfileButton(){let e=document.querySelector(".menu__link_style"),t=document.createElement("a");$.fancybox.close(),e.remove(),t.classList.add("menu__link","menu__link_style"),t.innerText="Личный кабинет",t.setAttribute("data-fancybox","modalAccount"),t.setAttribute("data-src","#modalAccount"),t.style.cursor="pointer",buttonBlock.prepend(t)}buttonProfileExit.addEventListener("click",function(e){e.preventDefault(),!0===confirm("Вы уверены, что хотите выйти?")&&(adminRight=!1,cartActive=!1,isActive=!1,profiles.forEach(e=>{e.active=!1}),localStorage.setItem("WildBook's profiles",JSON.stringify(profiles)),changeProfileButton(),checkCart())});let email=document.querySelector("#regEmail"),login=document.querySelector("#regLogin"),password=document.querySelector("#regPassword"),photo=document.querySelector(".modalReg__photo"),inputPhoto=document.querySelector(".modalReg__setPhoto");function profileRegistration(){let e=document.querySelector(".modalReg__button");e.addEventListener("click",()=>{if(""===email.value||""===login.value||""===password.value)e.removeAttribute("data-fancybox");else{e.setAttribute("data-fancybox","modalSuccessfulReg");let t={email:email.value,login:login.value,password:password.value,photo:photo.src};profiles.push(t),localStorage.setItem("WildBook's profiles",JSON.stringify(profiles))}})}function chooseFileProfile(e){let t=e.target,o=new FileReader;o.onload=function(){let e=o.result;document.querySelector(".modalProfile__photo").src=e},o.readAsDataURL(t.files[0]),photoChanged=!0}function chooseFileReg(e){let t=e.target,o=new FileReader;o.onload=function(){let e=o.result;document.querySelector(".modalReg__photo").src=e},o.readAsDataURL(t.files[0])}profileRegistration();let buttonRegExit=document.querySelector(".modalSuccessReg__button");function checkCart(){!0===cartActive?cart.classList.remove("menu__icon_style"):cart.classList.add("menu__icon_style")}function createBooks(e="./img/books/Books-error.png",t="Название книги не найдено."){return`<img src="${e}" alt="Book" class="section2__bookImage">\n            <h3 class="section2__name">${t}</h3>`}function returnBook(e){let t;return parseJSON().forEach(o=>{+e==+o.id&&(t=o)}),t}buttonRegExit.addEventListener("click",()=>{document.querySelectorAll(".modal").forEach(e=>{$.fancybox.close()}),email.value="",login.value="",password.value="",photo.src="./img/ProfilesPhotos/no-photo.jpg"});let returnedId=[],aside=document.querySelector(".section2__aside");function renderBookStars(){for(let e=0;e<returnedId.length;e++){let t=returnBook(returnedId[e]),o=document.createElement("div"),n=document.createElement("div");o.classList.add("section2__asideItem"),n.classList.add("section2__rating"),o.setAttribute("data-book","viewBook"),o.dataset.id=t.id,o.innerHTML=createBooks(t.imageUrl,t.name),aside.append(o);let a=document.querySelectorAll(".section2__asideItem");for(let e=0;e<t.rating;e++){let e=document.createElement("div");e.classList.add("section2__star"),e.innerText="★",n.append(e)}for(let e=t.rating;e<5;e++){let e=document.createElement("div");e.classList.add("section2__star","section2__star_style"),e.innerText="★",n.append(e)}a.forEach(e=>{e.append(n),e.addEventListener("click",()=>{let t=returnBook(e.dataset.id);renderInfoBooks(t.id,t.imageUrl,t.name,t.publishingHouse,t.genre,t.author,t.year,t.description,t.price),addUrl(t.id,"view"),openEditBooks()})})}openAddBooks()}function filter_and_render_stars(){function e(e){parseJSON().forEach(t=>{t.price===e&&(returnedId.push(t.id),booksFilteredId=returnedId.filter(function(e,t){return returnedId.indexOf(e)==t}))})}for(let t=0;t<booksPrice.length;t++)e(booksPrice[t]);for(let e=0;e<booksFilteredId.length;e++){let t=returnBook(booksFilteredId[e]),o=document.createElement("div"),n=document.createElement("div");o.classList.add("section2__asideItem"),n.classList.add("section2__rating"),o.setAttribute("data-book","viewBook"),o.dataset.id=t.id,o.innerHTML=createBooks(t.imageUrl,t.name),aside.append(o);let a=document.querySelectorAll(".section2__asideItem");for(let e=0;e<t.rating;e++){let e=document.createElement("div");e.classList.add("section2__star"),e.innerText="★",n.append(e)}for(let e=t.rating;e<5;e++){let e=document.createElement("div");e.classList.add("section2__star","section2__star_style"),e.innerText="★",n.append(e)}a.forEach(e=>{e.append(n),e.addEventListener("click",()=>{let t=returnBook(e.dataset.id);renderInfoBooks(t.id,t.imageUrl,t.name,t.publishingHouse,t.genre,t.author,t.year,t.description,t.price),addUrl(t.id,"view"),openEditBooks()})})}openAddBooks()}function renderDefaultBooks(){aside.innerHTML="";let e=document.createElement("div"),t=document.createElement("i");e.classList.add("section2__blockAdd"),t.classList.add("far","fa-plus-square","section2__add"),e.append(t),aside.append(e),parseJSON().forEach(e=>{let t=document.createElement("div"),o=document.createElement("div");t.classList.add("section2__asideItem"),o.classList.add("section2__rating"),t.setAttribute("data-book","viewBook"),t.dataset.id=e.id,t.innerHTML=createBooks(e.imageUrl,e.name),aside.append(t);let n=document.querySelectorAll(".section2__asideItem");for(let t=0;t<e.rating;t++){let e=document.createElement("div");e.classList.add("section2__star"),e.innerText="★",o.append(e)}for(let t=e.rating;t<5;t++){let e=document.createElement("div");e.classList.add("section2__star","section2__star_style"),e.innerText="★",o.append(e)}n.forEach(e=>{e.append(o),e.addEventListener("click",()=>{let t=returnBook(e.dataset.id);renderInfoBooks(t.id,t.imageUrl,t.name,t.publishingHouse,t.genre,t.author,t.year,t.description,t.price),addUrl(t.id,"view"),openEditBooks()})})}),openAddBooks()}function renderNewBooks(){aside.innerHTML="";let e=document.createElement("div"),t=document.createElement("i");e.classList.add("section2__blockAdd"),t.classList.add("far","fa-plus-square","section2__add"),e.append(t),aside.append(e),parseJSON().forEach(e=>{if(!0===e.New){let t=document.createElement("div"),o=document.createElement("div");t.classList.add("section2__asideItem"),o.classList.add("section2__rating"),t.setAttribute("data-book","viewBook"),t.dataset.id=e.id,t.innerHTML=createBooks(e.imageUrl,e.name),aside.append(t);let n=document.querySelectorAll(".section2__asideItem");for(let t=0;t<e.rating;t++){let e=document.createElement("div");e.classList.add("section2__star"),e.innerText="★",o.append(e)}for(let t=e.rating;t<5;t++){let e=document.createElement("div");e.classList.add("section2__star","section2__star_style"),e.innerText="★",o.append(e)}n.forEach(e=>{e.append(o),e.addEventListener("click",()=>{let t=returnBook(e.dataset.id);renderInfoBooks(t.id,t.imageUrl,t.name,t.publishingHouse,t.genre,t.author,t.year,t.description,t.price),addUrl(t.id,"view"),openEditBooks()})}),openAddBooks()}})}!function(){let e=document.querySelector("#range"),t=document.querySelector("#activeRange"),o=document.querySelector("#filter");t.innerText=`${e.value}₴`,e.addEventListener("input",()=>{t.innerText=`${e.value}₴`}),o.addEventListener("click",()=>{aside.innerHTML="",returnedId=[];let t=document.createElement("div"),o=document.createElement("i");t.classList.add("section2__blockAdd"),o.classList.add("far","fa-plus-square","section2__add"),t.append(o),aside.append(t),parseJSON().forEach(t=>{t.price<=e.value&&returnedId.push(t.id)}),renderBookStars()})}(),renderDefaultBooks();let booksPrice=[],booksFilteredId=[];function renderMaxToMinBooks(){aside.innerHTML="",returnedId=[];let e=document.createElement("div"),t=document.createElement("i");e.classList.add("section2__blockAdd"),t.classList.add("far","fa-plus-square","section2__add"),e.append(t),aside.append(e),parseJSON().forEach(e=>{booksPrice.push(e.price)}),booksPrice.sort(function(e,t){return t-e}),filter_and_render_stars()}function renderMinToMaxBooks(){aside.innerHTML="",returnedId=[];let e=document.createElement("div"),t=document.createElement("i");e.classList.add("section2__blockAdd"),t.classList.add("far","fa-plus-square","section2__add"),e.append(t),aside.append(e),parseJSON().forEach(e=>{booksPrice.push(e.price)}),booksPrice.sort(function(e,t){return e-t}),filter_and_render_stars()}function renderMaxRatingBooks(){let e=[];aside.innerHTML="",returnedId=[];let t=document.createElement("div"),o=document.createElement("i");function n(e){parseJSON().forEach(t=>{t.rating===e&&(returnedId.push(t.id),booksFilteredId=returnedId.filter(function(e,t){return returnedId.indexOf(e)==t}))})}t.classList.add("section2__blockAdd"),o.classList.add("far","fa-plus-square","section2__add"),t.append(o),aside.append(t),parseJSON().forEach(t=>{e.push(t.rating)}),e.sort(function(e,t){return t-e});for(let t=0;t<e.length;t++)n(e[t]);for(let e=0;e<booksFilteredId.length;e++){let t=returnBook(booksFilteredId[e]),o=document.createElement("div"),n=document.createElement("div");o.classList.add("section2__asideItem"),n.classList.add("section2__rating"),o.setAttribute("data-book","viewBook"),o.dataset.id=t.id,o.innerHTML=createBooks(t.imageUrl,t.name),aside.append(o);let a=document.querySelectorAll(".section2__asideItem");for(let e=0;e<t.rating;e++){let e=document.createElement("div");e.classList.add("section2__star"),e.innerText="★",n.append(e)}for(let e=t.rating;e<5;e++){let e=document.createElement("div");e.classList.add("section2__star","section2__star_style"),e.innerText="★",n.append(e)}a.forEach(e=>{e.append(n),e.addEventListener("click",()=>{let t=returnBook(e.dataset.id);renderInfoBooks(t.id,t.imageUrl,t.name,t.publishingHouse,t.genre,t.author,t.year,t.description,t.price),addUrl(t.id,"view"),openEditBooks()})})}openAddBooks()}function returnBookName(){let e=document.querySelector(".section2__searchBook").value;aside.innerHTML="",returnedId=[];let t=document.createElement("div"),o=document.createElement("i");t.classList.add("section2__blockAdd"),o.classList.add("far","fa-plus-square","section2__add"),t.append(o),aside.append(t),parseJSON().forEach(t=>{e===t.name&&returnedId.push(t.id)}),renderBookStars()}function returnBookAuthor(){let e=document.querySelector(".section2__searchBook").value;aside.innerHTML="",returnedId=[];let t=document.createElement("div"),o=document.createElement("i");t.classList.add("section2__blockAdd"),o.classList.add("far","fa-plus-square","section2__add"),t.append(o),aside.append(t),parseJSON().forEach(t=>{e===t.author&&returnedId.push(t.id)}),renderBookStars()}function returnBookGenre(){let e=document.querySelector(".section2__searchBook").value;returnedId=[],aside.innerHTML="";let t=document.createElement("div"),o=document.createElement("i");t.classList.add("section2__blockAdd"),o.classList.add("far","fa-plus-square","section2__add"),t.append(o),aside.append(t),parseJSON().forEach(t=>{e===t.genre&&returnedId.push(t.id)}),renderBookStars()}function filterTypes(){document.querySelector(".section2__list").addEventListener("change",()=>{switch(document.querySelector(".section2__list").value){case"default":renderDefaultBooks();break;case"new":renderNewBooks();break;case"priceMax":renderMaxToMinBooks();break;case"priceMin":renderMinToMaxBooks();break;case"rating":renderMaxRatingBooks();break;default:renderDefaultBooks()}})}function filterRadios(){let e=document.querySelector("#radioName"),t=document.querySelector("#radioAuthor"),o=document.querySelector("#radioGenre");document.querySelector(".section2__button").addEventListener("click",()=>{e.checked&&returnBookName(),t.checked&&returnBookAuthor(),o.checked&&returnBookGenre()})}function createInfoBooks(e=`${Math.random()}`,t="./img/books/Books-error.png",o="Название книги не найдено.",n="Издательство книги не найдено.",a="Жанр книги не найден.",i="Автор книги не найден",r="Год выпуска книги не найден",s="Описание книги не найдено",c="Цена книги не найдена."){return`<div class="section2__info" data-id="${e}">\n                <div class="section2__pic">\n                    <img src="${t}" alt="Book" class="section2__picture">\n                </div>\n                <div class="section2__information">\n                    <h3 class="section2__h3 section2__h3_style">${o}</h3>\n                    <h3 class="section2__h3"><span class="section2__inline">Издательство:</span> ${n}</h3>\n                    <h3 class="section2__h3"><span class="section2__inline">Жанр:</span> ${a}</h3>\n                    <span class="section2__author"><span class="section2__inline">Автор:</span> ${i}</span>\n                    <span class="section2__author"><span class="section2__inline">Год издания:</span> ${r}</span>\n                    <span class="section2__author"><span class="section2__inline">Цена:</span> ${c}₴</span>\n                    <div class="section2__desc">\n                        <a class="section2__showDesc" data-fancybox="modalDesc" data-src="#modalDesc" href="javascript:;">Прочесть описание</a>\n                        <div class="section2__control">\n                            <span class="section2__amount">Количество: </span>\n                            <button type="button" class="section2__btnMinus">-</button>\n                            <div class="section2__inputBlock">\n                                <input type="number" class="section2__count" min="1" max="20" value="1" data-oldprice="${c}"></input>\n                            </div>\n                            <button type="button" class="section2__btnPlus">+</button>\n                        </div>\n                    </div>\n                    <div class="modalDesc" id="modalDesc">\n                        <h3 class="section2__modalTitle">Описание</h3>\n                        <h2 class="section2__modalDesc">${s}</h2>\n                    </div>\n                    <div class="section2__btnBuy">\n                        <div class="section2__hint">Вы не зарегистрированы.</div>\n                    </div>\n                </div>\n            </div>`}function renderInfoBooks(e,t,o,n,a,i,r,s,c){document.querySelector(".section2__booksInfo").innerHTML=createInfoBooks(e,t,o,n,a,i,r,s,c);let d=document.querySelector(".section2__pic"),l=document.createElement("i"),u=document.querySelector(".section2__blockAdd"),_=document.querySelector(".section2__count"),m=document.querySelector(".section2__control"),p=document.createElement("button"),k=document.querySelector(".section2__btnBuy");if(l.classList.add("far","fa-edit","section2__edit"),p.classList.add("section2__buttonBuy"),p.innerText="В корзину",k.prepend(p),!0===adminRight?(d.prepend(l),u.style.display="block"):(l.remove(),u.style.display="none"),!0===isActive){m.classList.remove("section2__control_style"),p.classList.remove("section2__buttonBuy_style"),p.removeAttribute("disabled");let n=document.querySelector("#cartCount"),a=+cart.innerText,i=document.querySelector(".section2__btnMinus"),r=document.querySelector(".section2__btnPlus"),s=c,d={orderId:e,orderPrice:c,orderAmount:+_.value};i.addEventListener("click",function(){_.value>1&&(_.value--,function(){let t=+_.dataset.oldprice;s-=t,_.dataset.increasedprice=s,d={orderId:e,orderPrice:s,orderAmount:+_.value}}())}),r.addEventListener("click",function(){_.value<20&&(_.value++,function(){let t=+_.dataset.oldprice;s+=t,_.dataset.increasedprice=s,d={orderId:e,orderPrice:s,orderAmount:+_.value}}())}),p.addEventListener("click",function(i){i.preventDefault(),alert("Книга успешно добавлена в корзину.");let r=document.createElement("div"),c=document.querySelector(".modalCart__buyBlock");r.classList.add("modalCart__item"),r.dataset.id=e,r.dataset.price=s,r.dataset.amount=+_.value,c.style.display="flex",cartItems.push(d),a=cartItems.length,n.innerText=a,localStorage.setItem("WildBook's cart",JSON.stringify(cartItems)),r.innerHTML=createCartItem(t,o,d.orderPrice,d.orderAmount),cartItemsBlock.append(r);let l=document.querySelector("#finalPrice"),u=document.querySelectorAll(".modalCart__price"),m=0,p=e=>{l.textContent=`${e}₴`};function k(){$(this).closest($(".modalCart__item")).remove(),function(e){let t=0;e.forEach(e=>t+=parseInt(e.textContent)),p(t)}(u=document.querySelectorAll(".modalCart__price")),function(e){let t;cartItems=[],e.each(function(){t={orderId:+$(this).attr("data-id"),orderPrice:+$(this).attr("data-price"),orderAmount:+$(this).attr("data-amount")},cartItems.push(t)}),localStorage.setItem("WildBook's cart",JSON.stringify(cartItems)),0===cartItems.length&&(c.style.display="none")}($(".modalCart__item")),a=cartItems.length,n.innerText=a}u.forEach(e=>m+=parseInt(e.textContent)),p(m),$(".modalCart__delete").each(function(){$(this).on("click",k)})})}else m.classList.add("section2__control_style"),p.classList.add("section2__buttonBuy_style"),p.setAttribute("disabled","disabled")}function addUrl(e,t){history.pushState({id:e,action:t},null,`?id=${e}#${t}`)}filterTypes(),filterRadios(),function(){let e=[];parseJSON().forEach(t=>{e.push(t.id)}),renderInfoBooks(returnBook(e[0]).id,returnBook(e[0]).imageUrl,returnBook(e[0]).name,returnBook(e[0]).publishingHouse,returnBook(e[0]).genre,returnBook(e[0]).author,returnBook(e[0]).year,returnBook(e[0]).description,returnBook(e[0]).price),addUrl(returnBook(e[0]).id,"view")}();let asideItems=document.querySelectorAll(".section2__asideItem");function bookClick(){asideItems.forEach(e=>{e.addEventListener("click",()=>{let t=returnBook(e.dataset.id);renderInfoBooks(t.id,t.imageUrl,t.name,t.publishingHouse,t.genre,t.author,t.year,t.description,t.price),addUrl(t.id,"view"),openEditBooks()})})}function checkAdress(){let e=location.hash.slice(1),t=location.search.slice(4);if(""!==e||""!==t){if("View"===e&&renderInfoBooks(returnBook(t).id,returnBook(t).imageUrl,returnBook(t).name,returnBook(t).publishingHouse,returnBook(t).genre,returnBook(t).author,returnBook(t).year,returnBook(t).description,returnBook(t).price),"Edit"===e){renderEditInfoBooks(returnBook(t).id,returnBook(t).imageUrl,returnBook(t).name,returnBook(t).publishingHouse,returnBook(t).genre,returnBook(t).author,returnBook(t).year,returnBook(t).description,returnBook(t).price,returnBook(t).rating);let e=document.querySelector('[data-radio="new"]'),o=document.querySelector('[data-radio="notNew"]'),n=returnBook(t).New;!0===n?e.setAttribute("checked",""):!1===n&&o.setAttribute("checked","")}""===t&&"Add"===e&&renderAddInfoBooks()}}function openEditBooks(){let e=document.querySelector(".section2__edit"),t=location.search.slice(4);e.addEventListener("click",()=>{let e=returnBook(t);addUrl(e.id,"edit"),renderEditInfoBooks(e.id,e.imageUrl,e.name,e.publishingHouse,e.genre,e.author,e.year,e.description,e.price,e.rating);let o=document.querySelector('[data-radio="new"]'),n=document.querySelector('[data-radio="notNew"]'),a=e.New;!0===a?o.setAttribute("checked",""):!1===a&&n.setAttribute("checked","")})}function createEditInfoBooks(e=`${Math.random()}`,t="./img/books/Books-error.png",o="Название книги не найдено.",n="Издательство книги не найдено.",a="Жанр книги не найден.",i="Автор книги не найден",r="Год выпуска книги не найден",s="Описание книги не найдено",c="Цена книги не найдена",d="Рейтинг книги не найден"){return`<div class="section2__info" data-id="${e}">\n                <div class="section2__pic">\n                    <img src="${t}" alt="Book" class="section2__picture" data-book="imgPath">\n                    <input type="file" class="section2__file" onchange="chooseFile(event)" accept="image/*">\n                </div>\n                <div class="section2__information section2__information_edit">\n                    <input type="text" class="section2__input section2__input_style" value="${o}" maxlength="100" data-book="bookName">\n                    <div class="section2__inputs">\n                        <span class="section2__inline section2__inline_style">Издательство:</span>\n                        <input type="text" class="section2__input" value="${n}" maxlength="100" data-book="bookPublishing">\n                    </div>\n                    <div class="section2__inputs">\n                        <span class="section2__inline section2__inline_style">Жанр:</span>\n                        <input type="text" class="section2__input" value="${a}" maxlength="100" data-book="bookGenre">\n                    </div>\n                    <div class="section2__inputs">\n                        <span class="section2__inline section2__inline_style">Автор:</span>\n                        <input type="text" class="section2__input" value="${i}" maxlength="100" data-book="bookAuthor">\n                    </div>\n                    <div class="section2__inputs">\n                        <span class="section2__inline section2__inline_style">Год издания:</span>\n                        <input type="number" class="section2__input" value="${r}" data-book="bookYear" min="868">\n                    </div>\n                    <div class="section2__inputs">\n                        <span class="section2__inline section2__inline_style">Цена:</span>\n                        <input type="number" class="section2__input" value="${c}" data-book="bookPrice" min="50">\n                    </div>\n                    <div class="section2__inputs">\n                        <span class="section2__inline section2__inline_style">Рейтинг:</span>\n                        <input type="number" class="section2__input" value="${d}" min="1" max="5" data-book="bookRating">\n                    </div>\n                    <div class="section2__inputs">\n                        <span class="section2__inline section2__inline_style">Новинка:</span>\n                        <span class="section2__chooseSpan section2__chooseSpan_style">Да</span> <input type="radio" data-radio="new" class="section2__radio" name="editRadios">\n                        <span class="section2__chooseSpan">Нет</span> <input type="radio" data-radio="notNew" class="section2__radio"  name="editRadios">\n                    </div>\n                    <div class="section2__desc">\n                        <a class="section2__showDesc" data-fancybox="modalEditDesc" data-src="#modalEditDesc" href="javascript:;">Изменить описание</a>\n                    </div>\n                    <div class="modalDesc" id="modalEditDesc">\n                        <h3 class="section2__modalTitle">Описание</h3>\n                        <div class="section2__modalText">\n                            <textarea cols="30" rows="10" class="section2__modalArea" data-book="bookDesc">${s}</textarea>\n                        </div>\n                    </div>\n                    <div class="section2__buttons">\n                        <button class="section2__editButton section2__editSave" data-button="save">Сохранить</button>\n                        <div class="section2__editBlock">\n                            <button class="section2__editButton section2__editCancel" data-button="cancel">Отменить</button>\n                        </div>\n                    </div>\n                </div>\n            </div>`}function renderEditInfoBooks(e,t,o,n,a,i,r,s,c,d){document.querySelector(".section2__booksInfo").innerHTML=createEditInfoBooks(e,t,o,n,a,i,r,s,c,d),acceptEditChanges(e)}function acceptEditChanges(e){let t,o=document.querySelector('[data-book="imgPath"]'),n=document.querySelector('[data-book="bookName"]'),a=document.querySelector('[data-book="bookPublishing"]'),i=document.querySelector('[data-book="bookGenre"]'),r=document.querySelector('[data-book="bookAuthor"]'),s=document.querySelector('[data-book="bookYear"]'),c=document.querySelector('[data-book="bookPrice"]'),d=document.querySelector('[data-book="bookRating"]'),l=document.querySelector('[data-radio="new"]'),u=document.querySelector('[data-radio="notNew"]'),_=document.querySelector('[data-book="bookDesc"]'),m=document.querySelector('[data-button="save"]'),p=document.querySelector('[data-button="cancel"]');m.addEventListener("click",()=>{l.checked?t=!0:u.checked&&(t=!1);let m,p={id:e,name:n.value,publishingHouse:a.value,genre:i.value,author:r.value,year:s.value,description:_.value,price:+c.value,rating:+d.value,imageUrl:o.src,New:t};updateBook(e,p),m=returnBook(p.id),setTimeout(()=>{alert("Книга успешно обновлена.")},450),renderInfoBooks(m.id,m.imageUrl,m.name,m.publishingHouse,m.genre,m.author,m.year,m.description,m.price),addUrl(m.id,"view"),openEditBooks(),renderDefaultBooks(),bookClick()}),p.addEventListener("click",()=>{let t=returnBook(e);if(!0===confirm("Вы уверены, что хотите отменить изменения?")){renderEditInfoBooks(t.id,t.imageUrl,t.name,t.publishingHouse,t.genre,t.author,t.year,t.description,t.price,t.rating);let e=document.querySelector('[data-radio="new"]'),o=document.querySelector('[data-radio="notNew"]'),n=t.New;!0===n?e.setAttribute("checked",""):!1===n&&o.setAttribute("checked",""),renderInfoBooks(t.id,t.imageUrl,t.name,t.publishingHouse,t.genre,t.author,t.year,t.description,t.price),addUrl(t.id,"view")}})}function updateBook(e,t){let o,n=parseJSON();n.forEach(t=>{t.id===e&&(o=n.indexOf(t))}),n[o]=t,localStorage.setItem("WildBook's books",JSON.stringify(n))}function chooseFile(e){let t=e.target,o=new FileReader;o.onload=function(){let e=o.result;document.querySelector(".section2__picture").src=e},o.readAsDataURL(t.files[0])}function createAddInfoBooks(e="./img/books/Books-error.png"){return`<div class="section2__info" data-id>\n                <div class="section2__pic">\n                    <img src="${e}" alt="Book" class="section2__picture" data-book="imgPath">\n                    <input type="file" class="section2__file" onchange="chooseFile(event)" accept="image/*">\n                </div>\n                <div class="section2__information section2__information_add">\n                    <input type="text" class="section2__input section2__input_style" placeholder="ID книги" maxlength="100" data-book="bookId">\n                    <div class="section2__inputs">\n                        <input type="text" class="section2__input section2__input_style" placeholder="Название книги" maxlength="100" data-book="bookName">\n                    </div>\n                    <div class="section2__inputs">\n                        <span class="section2__inline section2__inline_style">Издательство:</span>\n                        <input type="text" class="section2__input" value="" maxlength="100" data-book="bookPublishing">\n                    </div>\n                    <div class="section2__inputs">\n                        <span class="section2__inline section2__inline_style">Жанр:</span>\n                        <input type="text" class="section2__input" value="" maxlength="100" data-book="bookGenre">\n                    </div>\n                    <div class="section2__inputs">\n                        <span class="section2__inline section2__inline_style">Автор:</span>\n                        <input type="text" class="section2__input" value="" maxlength="100" data-book="bookAuthor">\n                    </div>\n                    <div class="section2__inputs">\n                        <span class="section2__inline section2__inline_style">Год издания:</span>\n                        <input type="number" class="section2__input" value="" data-book="bookYear" min="868">\n                    </div>\n                    <div class="section2__inputs">\n                        <span class="section2__inline section2__inline_style">Цена:</span>\n                        <input type="number" class="section2__input" value="" data-book="bookPrice" min="50">\n                    </div>\n                    <div class="section2__inputs">\n                        <span class="section2__inline section2__inline_style">Рейтинг:</span>\n                        <input type="number" class="section2__input" value="" min="1" max="5" data-book="bookRating">\n                    </div>\n                    <div class="section2__inputs">\n                        <span class="section2__inline section2__inline_style">Новинка:</span>\n                        <span class="section2__chooseSpan section2__chooseSpan_style">Да</span> <input type="radio" data-radio="new" class="section2__radio" name="editRadios" checked>\n                        <span class="section2__chooseSpan">Нет</span> <input type="radio" data-radio="notNew" class="section2__radio"  name="editRadios">\n                    </div>\n                    <div class="section2__desc">\n                        <a class="section2__showDesc" data-fancybox="modalEditDesc" data-src="#modalEditDesc" href="javascript:;">Внести описание</a>\n                    </div>\n                    <div class="modalDesc" id="modalEditDesc">\n                        <h3 class="section2__modalTitle">Описание</h3>\n                        <div class="section2__modalText">\n                            <textarea cols="30" rows="10" class="section2__modalArea" data-book="bookDesc"></textarea>\n                        </div>\n                    </div>\n                    <div class="section2__buttons">\n                        <button class="section2__editButton section2__editSave" data-button="accept">Добавить</button>\n                        <div class="section2__editBlock">\n                            <button class="section2__editButton section2__editCancel" data-button="cancel">Отменить</button>\n                        </div>\n                    </div>\n                </div>\n            </div>`}function renderAddInfoBooks(){document.querySelector(".section2__booksInfo").innerHTML=createAddInfoBooks(),acceptAddChanges()}function openAddBooks(){document.querySelector(".section2__add").addEventListener("click",()=>{history.pushState({action:"add"},null,"#add"),renderAddInfoBooks()})}function acceptAddChanges(){let e,t=document.querySelector('[data-book="imgPath"]'),o=document.querySelector('[data-book="bookId"]'),n=document.querySelector('[data-book="bookName"]'),a=document.querySelector('[data-book="bookPublishing"]'),i=document.querySelector('[data-book="bookGenre"]'),r=document.querySelector('[data-book="bookAuthor"]'),s=document.querySelector('[data-book="bookYear"]'),c=document.querySelector('[data-book="bookPrice"]'),d=document.querySelector('[data-book="bookRating"]'),l=document.querySelector('[data-radio="new"]'),u=document.querySelector('[data-radio="notNew"]'),_=document.querySelector('[data-book="bookDesc"]'),m=document.querySelector('[data-button="accept"]'),p=document.querySelector('[data-button="cancel"]');m.addEventListener("click",()=>{l.checked?e=!0:u.checked&&(e=!1);let m,p={id:+o.value,name:n.value,publishingHouse:a.value,genre:i.value,author:r.value,year:s.value,description:_.value,price:+c.value,rating:+d.value,imageUrl:t.src,New:e},k=parseJSON();k.push(p),localStorage.setItem("WildBook's books",JSON.stringify(k)),m=returnBook(p.id),setTimeout(()=>{alert("Книга успешно добавлена в каталог.")},450),renderInfoBooks(m.id,m.imageUrl,m.name,m.publishingHouse,m.genre,m.author,m.year,m.description,m.price),addUrl(m.id,"view"),openEditBooks(),renderDefaultBooks(),bookClick()}),p.addEventListener("click",()=>{!0===confirm("Вы уверены, что хотите отменить добавление книги?")&&renderAddInfoBooks()})}bookClick(),checkAdress(),$(document).ready(function(){let e=document.querySelector(".menu__link_style");profiles.forEach(t=>{if(t.active){adminRight=!0,isActive=!0,cartActive=!0,$.fancybox.close(),e.remove();let o=document.createElement("a");o.classList.add("menu__link","menu__link_style"),o.innerText=t.login,o.setAttribute("data-fancybox","modalProfile"),o.setAttribute("data-src","#modalProfile"),o.style.cursor="pointer",buttonBlock.prepend(o),profilePhoto.setAttribute("src",`${t.photo}`),profileEmail.value=t.email,profileLogin.value=t.login,profilePassword.value=t.password,checkCart()}})});let modalCart=document.querySelector("#modalCart"),cartImage=document.querySelector(".modalCart__image"),cartItemsBlock=document.querySelector(".modalCart__items");function createCartItem(e,t,o,n){return`<div class="modalCart__remove">\n                <i class="far fa-trash-alt modalCart__delete"></i>\n            </div>\n            <img src="${e}" alt="${t}" class="modalCart__image">\n            <div class="modalCart__info">\n                <p class="modalCart__name">Название: ${t}</p>\n                <div class="modalCart__count"><span class="modalCart__span">Количество: ${n}</span></div>\n                <div>Цена: <span class="modalCart__price">${o}</span>₴</div>\n            </div>`}cartButton.addEventListener("click",()=>{if(!0!==cartActive)return alert("Зарегистрируйтесь, что бы иметь доступ к своей личной корзине."),cartButton.style.cursor="pointer",cartButton.removeAttribute("data-fancybox","modalCart"),cartButton.removeAttribute("data-src","#modalCart"),void cartButton.removeAttribute("href","javascript:;");cartButton.setAttribute("data-fancybox","modalCart"),cartButton.setAttribute("data-src","#modalCart"),cartButton.setAttribute("href","javascript:;")});let cartSpan=document.querySelector("#cartCount"),cartCount=+cart.innerText;!function(){cartItems.forEach(e=>{let t=document.createElement("div");t.classList.add("modalCart__item"),t.dataset.id=e.orderId,t.dataset.price=e.orderPrice,t.dataset.amount=e.orderAmount,cartCount=cartItems.length,cartSpan.innerText=cartCount,t.innerHTML=createCartItem(returnBook(e.orderId).imageUrl,returnBook(e.orderId).name,e.orderPrice,e.orderAmount),cartItemsBlock.append(t)});let e=document.querySelector("#finalPrice"),t=document.querySelectorAll(".modalCart__price"),o=0,n=document.querySelector(".modalCart__buy"),a=document.querySelector(".modalCart__buyBlock");0===cartItems.length&&(a.style.display="none");let i=t=>{e.textContent=`${t}₴`};function r(){$(this).closest($(".modalCart__item")).remove(),function(e){let t=0;e.forEach(e=>t+=parseInt(e.textContent)),i(t)}(t=document.querySelectorAll(".modalCart__price")),function(e){let t;cartItems=[],e.each(function(){t={orderId:+$(this).attr("data-id"),orderPrice:+$(this).attr("data-price"),orderAmount:+$(this).attr("data-amount")},cartItems.push(t)}),localStorage.setItem("WildBook's cart",JSON.stringify(cartItems))}($(".modalCart__item")),cartCount=cartItems.length,cartSpan.innerText=cartCount,0===cartItems.length&&(a.style.display="none")}t.forEach(e=>o+=parseInt(e.textContent)),i(o),$(".modalCart__delete").each(function(){$(this).on("click",r)}),n.addEventListener("click",()=>{!function(){let e=document.querySelector(".modalCart__email");""===e.value||" "===e.value?n.removeAttribute("type"):(cartItems=[],localStorage.setItem("WildBook's cart",JSON.stringify(cartItems)),n.setAttribute("type","submit"))}()})}();